{
    "@context": [
        "https://www.w3.org/ns/activitystreams"
    ],
    "to": ["https://www.w3.org/ns/activitystreams#Public"],
    "name": "Node Require from Project Root",
    "type": "Article","content": "\u003ch1 id=\"node-require-from-project-root\"\u003eNode Require from Project Root\u003c/h1\u003e\n\u003ch2 id=\"問題\"\u003e問題\u003c/h2\u003e\n\u003cp\u003e在寫一個專案的時候，有時候會有一些小程式重複在不同的檔案裡用到，這時候我們會把他打包成模組放在 \u003ccode\u003elib/\u003c/code\u003e。但是如果資料夾結構有點點複雜的時候， \u003ccode\u003erequire()\u003c/code\u003e 的路徑就會很複雜：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── index.js\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── lib\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e│   └── random.js\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e└── routes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    └── page\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        └── signup\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            └── index.js\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003eindex.js\u003c/code\u003e 裡面如果要引入 \u003ccode\u003erandom.js\u003c/code\u003e 就會變成這樣\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003erandom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;../../lib/random.js\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"爛解法\"\u003e爛解法\u003c/h2\u003e\n\u003cp\u003e如果我們想要直接用 \u003ccode\u003erequire('lib/random')\u003c/code\u003e 的話做簡單的方式是上傳 npm，但是這樣稍嫌麻煩，而且別的專案不一定用的到。每一次修改都要上傳 npm 很不方便。\u003c/p\u003e\n\u003ch2 id=\"好解法\"\u003e好解法\u003c/h2\u003e\n\u003cp\u003e在 linux 裡面要把執行檔做成指令有兩個方法\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e放到 \u003ccode\u003e/usr/bin\u003c/code\u003e 之類的地方\u003c/li\u003e\n\u003cli\u003e把這個路徑直接加到 \u003ccode\u003ePATH\u003c/code\u003e 裡面\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e在 node 裡面也有 path 設定，\u003ccode\u003emodule.paths\u003c/code\u003e，在 require 時會去這個裡面的目路尋找檔案。所以如果要達成上述的功能的話就只要加這行就可以了\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e這樣就可以直接用 \u003ccode\u003erequire('lib/random')\u003c/code\u003e 引入了\u003c/p\u003e\n\u003ch2 id=\"參考資料\"\u003e參考資料\u003c/h2\u003e\n\u003cp\u003e\u003ca class=\"link\" href=\"https://github.com/nodejs/node/issues/4223\"  target=\"_blank\" rel=\"noopener\"\n    \u003ehttps://github.com/nodejs/node/issues/4223\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"link\" href=\"https://github.com/nodejs/node/issues/1979\"  target=\"_blank\" rel=\"noopener\"\n    \u003ehttps://github.com/nodejs/node/issues/1979\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"link\" href=\"https://www.npmjs.com/package/rooty\"  target=\"_blank\" rel=\"noopener\"\n    \u003ehttps://www.npmjs.com/package/rooty\u003c/a\u003e\u003cbr\u003e\n^^^\u003cbr\u003e\n這個是在 github issue 裡面看到的，沒試過，但是應該也可以用吧？只是我覺得沒有 \u003ccode\u003epaths\u003c/code\u003e 的解法來的優雅。\u003c/p\u003e\n","mediaType": "text/html",
    "published": "2020-09-02T00:00:00+00:00",
    "updated": "2020-09-02T00:00:00+00:00",
    "id": "https://blog.simbafs.cc/p/js/node-require-from-project-root/",
    "url": "https://blog.simbafs.cc/p/js/node-require-from-project-root/",
    "attributedTo": "https://blog.simbafs.cc"
}